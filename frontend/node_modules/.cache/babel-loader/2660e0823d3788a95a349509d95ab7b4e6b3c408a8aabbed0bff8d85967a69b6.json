{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import axios from'axios';import{getApiUrl}from'../config/api';import'./AdminProfilesPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminProfilesPage=()=>{const[profiles,setProfiles]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const navigate=useNavigate();useEffect(()=>{const fetchProfiles=async()=>{try{const response=await axios.get(getApiUrl('/api/profiles'));setProfiles(response.data);setLoading(false);}catch(error){console.error('Ошибка при загрузке анкет:',error);setLoading(false);}};fetchProfiles();},[]);const handleStatusChange=async(id,newStatus)=>{try{const response=await axios.patch(`http://localhost:5000/api/profiles/${id}/status`,{status:newStatus},{headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});// Обновляем список профилей после успешного изменения статуса\nsetProfiles(profiles.map(profile=>profile.id===id?response.data:profile));}catch(error){var _error$response,_error$response2,_error$response2$data;console.error('Ошибка при обновлении статуса:',((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error);setError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Ошибка при обновлении статуса');}};const handleDelete=async id=>{if(window.confirm('Вы уверены, что хотите удалить эту анкету?')){try{await axios.delete(`http://localhost:5000/api/profiles/${id}`,{headers:{'Authorization':`Bearer ${localStorage.getItem('token')}`}});// Обновляем список после удаления\nsetProfiles(profiles.filter(profile=>profile.id!==id));}catch(error){var _error$response3,_error$response4,_error$response4$data;console.error('Ошибка при удалении анкеты:',((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.data)||error);setError(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.message)||'Ошибка при удалении анкеты');}}};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-profiles-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0423\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0430\\u043D\\u043A\\u0435\\u0442\\u0430\\u043C\\u0438\"}),/*#__PURE__*/_jsx(Link,{to:\"/admin/create\",className:\"create-button\",children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u0430\\u043D\\u043A\\u0435\\u0442\\u0443\"})]}),profiles.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-profiles\",children:/*#__PURE__*/_jsx(\"p\",{children:\"\\u0410\\u043D\\u043A\\u0435\\u0442\\u044B \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u044B\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"profiles-table\",children:/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0418\\u043C\\u044F\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044F\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:profiles.map(profile=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:profile.id}),/*#__PURE__*/_jsx(\"td\",{children:profile.name}),/*#__PURE__*/_jsx(\"td\",{children:profile.age}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:profile.status,onChange:e=>handleStatusChange(profile.id,e.target.value),className:`status-select status-${profile.status}`,children:[/*#__PURE__*/_jsx(\"option\",{value:\"pending\",children:\"\\u041D\\u0430 \\u043C\\u043E\\u0434\\u0435\\u0440\\u0430\\u0446\\u0438\\u0438\"}),/*#__PURE__*/_jsx(\"option\",{value:\"active\",children:\"\\u0410\\u043A\\u0442\\u0438\\u0432\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"option\",{value:\"blocked\",children:\"\\u0417\\u0430\\u0431\\u043B\\u043E\\u043A\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0430\"})]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"actions\",children:[/*#__PURE__*/_jsx(Link,{to:`/admin/edit/${profile.id}`,className:\"edit-button\",children:\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(profile.id),className:\"delete-button\",children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})]})]},profile.id))})]})})]});};export default AdminProfilesPage;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","axios","getApiUrl","jsx","_jsx","jsxs","_jsxs","AdminProfilesPage","profiles","setProfiles","loading","setLoading","error","setError","navigate","fetchProfiles","response","get","data","console","handleStatusChange","id","newStatus","patch","status","headers","localStorage","getItem","map","profile","_error$response","_error$response2","_error$response2$data","message","handleDelete","window","confirm","delete","filter","_error$response3","_error$response4","_error$response4$data","className","children","to","length","name","age","value","onChange","e","target","onClick"],"sources":["/home/renat/Project_1/frontend/src/pages/AdminProfilesPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { getApiUrl } from '../config/api';\nimport './AdminProfilesPage.css';\n\nconst AdminProfilesPage = () => {\n  const [profiles, setProfiles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchProfiles = async () => {\n      try {\n        const response = await axios.get(getApiUrl('/api/profiles'));\n        setProfiles(response.data);\n        setLoading(false);\n      } catch (error) {\n        console.error('Ошибка при загрузке анкет:', error);\n        setLoading(false);\n      }\n    };\n\n    fetchProfiles();\n  }, []);\n\n  const handleStatusChange = async (id, newStatus) => {\n    try {\n      const response = await axios.patch(\n        `http://localhost:5000/api/profiles/${id}/status`,\n        { status: newStatus },\n        {\n          headers: {\n            'Authorization': `Bearer ${localStorage.getItem('token')}`\n          }\n        }\n      );\n\n      // Обновляем список профилей после успешного изменения статуса\n      setProfiles(profiles.map(profile => \n        profile.id === id ? response.data : profile\n      ));\n    } catch (error) {\n      console.error('Ошибка при обновлении статуса:', error.response?.data || error);\n      setError(error.response?.data?.message || 'Ошибка при обновлении статуса');\n    }\n  };\n\n  const handleDelete = async (id) => {\n    if (window.confirm('Вы уверены, что хотите удалить эту анкету?')) {\n      try {\n        await axios.delete(\n          `http://localhost:5000/api/profiles/${id}`,\n          {\n            headers: {\n              'Authorization': `Bearer ${localStorage.getItem('token')}`\n            }\n          }\n        );\n        // Обновляем список после удаления\n        setProfiles(profiles.filter(profile => profile.id !== id));\n      } catch (error) {\n        console.error('Ошибка при удалении анкеты:', error.response?.data || error);\n        setError(error.response?.data?.message || 'Ошибка при удалении анкеты');\n      }\n    }\n  };\n\n  if (loading) return <div className=\"loading\">Загрузка...</div>;\n  if (error) return <div className=\"error-message\">{error}</div>;\n\n  return (\n    <div className=\"admin-profiles-page\">\n      <div className=\"admin-header\">\n        <h1>Управление анкетами</h1>\n        <Link to=\"/admin/create\" className=\"create-button\">\n          Создать анкету\n        </Link>\n      </div>\n\n      {profiles.length === 0 ? (\n        <div className=\"no-profiles\">\n          <p>Анкеты не найдены</p>\n        </div>\n      ) : (\n        <div className=\"profiles-table\">\n          <table>\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Имя</th>\n                <th>Возраст</th>\n                <th>Статус</th>\n                <th>Действия</th>\n              </tr>\n            </thead>\n            <tbody>\n              {profiles.map(profile => (\n                <tr key={profile.id}>\n                  <td>{profile.id}</td>\n                  <td>{profile.name}</td>\n                  <td>{profile.age}</td>\n                  <td>\n                    <select\n                      value={profile.status}\n                      onChange={(e) => handleStatusChange(profile.id, e.target.value)}\n                      className={`status-select status-${profile.status}`}\n                    >\n                      <option value=\"pending\">На модерации</option>\n                      <option value=\"active\">Активна</option>\n                      <option value=\"blocked\">Заблокирована</option>\n                    </select>\n                  </td>\n                  <td className=\"actions\">\n                    <Link \n                      to={`/admin/edit/${profile.id}`} \n                      className=\"edit-button\"\n                    >\n                      Редактировать\n                    </Link>\n                    <button\n                      onClick={() => handleDelete(profile.id)}\n                      className=\"delete-button\"\n                    >\n                      Удалить\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AdminProfilesPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}