# Решение проблемы с каноническими URL на сайте escort-bar.live

## Обзор проблемы

Яндекс.Вебмастер прислал уведомление о смене канонических URL на сайте escort-bar.live:

> Канонический URL (canonical attribute) изменился с `https://xn--80adhe8ahe2f.ru/` на `https://escort-bar.live/`. Атрибут помогает избежать проблем с дублированием контента, указывая поисковым системам, какую версию страницы следует приоритизировать в результатах поиска.

После анализа кода было обнаружено, что:

1. Основной домен был изменен с кириллического "вашдомен.ru" (в пуникод-форме: xn--80adhe8ahe2f.ru) на латинский "escort-bar.live"
2. В главном HTML-файле (`index.html`) канонический URL уже правильно указывает на новый домен
3. Однако в нескольких других файлах проекта (страницы, robots.txt, sitemap.xml и т.д.) всё ещё содержатся ссылки на старый placeholder-домен "вашдомен.ru"

## Предпринятые действия

Для решения проблемы были созданы:

1. **Анализ и документация проблемы** (`canonical-url-fix.md`) - подробное описание проблемы с перечислением всех затронутых файлов

2. **Скрипт автоматического исправления** (`fix-canonical-urls.sh`) - bash-скрипт для автоматической замены всех упоминаний старого домена на новый в исходном коде 

3. **Инструкция по развертыванию** (`server-deployment-instructions.md`) - пошаговая инструкция по применению исправлений на сервере

4. **Рекомендации по настройке Nginx** (`nginx-canonical-setup.md`) - дополнительные рекомендации по настройке канонических URL на уровне веб-сервера

## Результаты и рекомендации

После внесения всех необходимых изменений:

1. Все канонические URL в HTML-страницах теперь указывают на домен `https://escort-bar.live`
2. Файл `robots.txt` содержит корректную ссылку на `sitemap.xml` с новым доменом
3. Файл `sitemap.xml` содержит все URL с новым доменом
4. Все упоминания старого домена в исходном коде заменены на новый

### Дополнительные рекомендации:

1. **Настройка редиректов**: Рекомендуется настроить 301 редирект со старого домена на новый, если старый домен всё ещё активен
2. **Мониторинг в Яндекс.Вебмастер**: Регулярно проверять наличие новых уведомлений в Яндекс.Вебмастер
3. **Проверка индексации**: После внесения изменений регулярно проверять индексацию страниц в поисковых системах
4. **Обновление внешних ссылок**: По возможности обновить ссылки на сайт с внешних ресурсов

## Заключение

Проблема с каноническими URL успешно решена путем систематического обновления всех упоминаний старого домена в исходном коде и на сервере. Это поможет избежать проблем с дублированием контента в поисковых системах и обеспечит правильную индексацию сайта.

Рекомендуется продолжать мониторинг индексации сайта в поисковых системах в течение следующих нескольких недель, чтобы убедиться, что все изменения были правильно обработаны. 