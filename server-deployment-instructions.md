# Инструкция по обновлению канонических URL на сервере

После исправления канонических URL в исходном коде проекта необходимо применить эти изменения на сервере. Вот пошаговая инструкция:

## 1. Запуск скрипта исправления URL в локальном проекте

Сначала запустите скрипт `fix-canonical-urls.sh` для автоматической замены старых URL в исходном коде:

```bash
# Сделайте скрипт исполняемым
chmod +x fix-canonical-urls.sh

# Запустите скрипт
./fix-canonical-urls.sh
```

## 2. Сборка проекта

После внесения изменений соберите проект:

```bash
# Переход в директорию фронтенда
cd frontend

# Установка зависимостей (если требуется)
npm install

# Сборка проекта
npm run build
```

## 3. Загрузка обновленных файлов на сервер

Загрузите собранные файлы на сервер:

```bash
# Синхронизация файлов на сервер
scp -r frontend/build/* root@185.255.120.50:/var/www/html/site/
```

Также необходимо обновить файл robots.txt:

```bash
scp frontend/public/robots.txt root@185.255.120.50:/var/www/html/site/robots.txt
```

## 4. Проверка обновленных файлов на сервере

Проверьте, что все файлы были успешно обновлены:

```bash
# Проверка канонических URL в index.html
ssh root@185.255.120.50 "grep -i 'canonical' /var/www/html/site/index.html"

# Проверка robots.txt
ssh root@185.255.120.50 "cat /var/www/html/site/robots.txt | grep 'Sitemap'"

# Проверка наличия старого домена в файлах
ssh root@185.255.120.50 "grep -r 'вашдомен.ru' /var/www/html/site/ --include='*.html' --include='*.js' --include='*.json' --include='*.txt'"
```

## 5. Перезапуск сервисов (если требуется)

В некоторых случаях может потребоваться перезапуск nginx:

```bash
ssh root@185.255.120.50 "systemctl reload nginx"
```

## 6. Переиндексация сайта

После обновления файлов на сервере важно запросить переиндексацию сайта в панелях вебмастеров:

1. Зайдите в [Яндекс.Вебмастер](https://webmaster.yandex.ru)
2. Выберите ваш сайт (escort-bar.live)
3. Перейдите в раздел "Индексирование" → "Переобход страниц"
4. Добавьте URL главной страницы и других важных разделов для быстрой переиндексации

Аналогично запросите переиндексацию в [Google Search Console](https://search.google.com/search-console).

## 7. Проверка в браузере

Проверьте, что канонические URL корректно отображаются в исходном коде страниц сайта через браузер:

1. Откройте сайт (https://escort-bar.live)
2. Просмотрите исходный код страницы (Ctrl+U в большинстве браузеров)
3. Найдите тег `<link rel="canonical"...` и убедитесь, что он содержит правильный домен

## Дополнительная проверка

Проверьте заголовки ответа сервера, чтобы убедиться, что канонический URL передается правильно:

```bash
curl -I https://escort-bar.live
```

Проверьте файл sitemap.xml на сервере:

```bash
curl https://escort-bar.live/sitemap.xml | grep "<loc>"
``` 